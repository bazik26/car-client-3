<!-- Hero Section -->
<section class="hero" id="hero">
  <div class="container">
    <div class="hero__content">
      <div class="hero__badge">
        <i class="fas fa-rocket"></i>
        <span>Премиум автоподбор из Европы</span>
      </div>
      
      <h1 class="hero__title">
        <span class="hero__title-main">Найдем вашу</span>
        <span class="hero__title-accent">идеальную машину</span>
        <span class="hero__title-sub">за 14 дней</span>
      </h1>
      
      <p class="hero__description">
        Эксклюзивный подбор автомобилей из Германии, Франции и Италии. 
        Полная проверка истории, техническая инспекция и гарантия качества. 
        <strong>Экономия до 30%</strong> по сравнению с российским рынком.
      </p>
      
      <div class="hero__actions">
        <a class="btn btn--primary" routerLink="/catalog">
          <i class="fas fa-search"></i>
          Найти авто мечты
        </a>
        <button class="btn btn--secondary" type="button" (click)="selectFilter(showcaseFilters[0])">
          <i class="fas fa-calculator"></i>
          Рассчитать стоимость
        </button>
      </div>
      
      <div class="hero__stats">
        <div class="stat-card">
          <div class="stat-number">500+</div>
          <div class="stat-label">Авто доставлено</div>
          <div class="stat-detail">в 2024 году</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">14</div>
          <div class="stat-label">дней</div>
          <div class="stat-detail">средний срок доставки</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">99%</div>
          <div class="stat-label">довольных клиентов</div>
          <div class="stat-detail">возвращаются к нам</div>
        </div>
      </div>
    </div>
    
    <div class="hero__visual">
      <div class="hero__stage">
        <span class="hero__halo hero__halo--primary"></span>
        <span class="hero__halo hero__halo--secondary"></span>
        <div class="hero__ring hero__ring--outer"></div>
        <div class="hero__ring hero__ring--inner"></div>

        <div class="hero__panel hero__panel--primary">
          <span class="hero__panel-label">Сделка недели</span>
          <strong>Range Rover Velar</strong>
          <span class="hero__panel-meta">2.9 млн ₽ · 2022 · 18 000 км</span>
          <div class="hero__panel-trend">
            <span class="trend-icon">↗</span>
            <span>+12 запросов за сутки</span>
          </div>
        </div>

        <div class="hero__panel hero__panel--secondary">
          <span class="hero__panel-label">В очереди на подбор</span>
          <strong>Mercedes-Benz EQE</strong>
          <span class="hero__panel-meta">Премиум электрокар · 14 дней</span>
        </div>

        <div class="hero__floating hero__floating--left">
          <span class="hero__floating-badge">VIN Control</span>
          <p>Полная цифровая проверка происхождения и сервисной истории из баз ЕС.</p>
        </div>

        <div class="hero__floating hero__floating--right">
          <span class="hero__floating-badge">Road Test</span>
          <p>Телеметрия и видео-отчёты после тест-драйва экспертом Prime Auto.</p>
        </div>
      </div>

      <ul class="hero__features">
        <li class="feature-card">
          <div class="feature-icon">
            <i class="fas fa-shield-alt"></i>
          </div>
          <div class="feature-content">
            <h4>Полная проверка</h4>
            <p>118 критериев по дилерским и страховым базам ЕС</p>
          </div>
        </li>
        <li class="feature-card">
          <div class="feature-icon">
            <i class="fas fa-euro-sign"></i>
          </div>
          <div class="feature-content">
            <h4>Прозрачная экономия</h4>
            <p>До 30% выгоды благодаря прямым контрактам и аукционам</p>
          </div>
        </li>
        <li class="feature-card">
          <div class="feature-icon">
            <i class="fas fa-clock"></i>
          </div>
          <div class="feature-content">
            <h4>Сроки под контролем</h4>
            <p>Логистика «под ключ»: оформление, доставка, постановка на учёт</p>
          </div>
        </li>
      </ul>
    </div>
  </div>
</section>

<!-- Best Offer Section -->
<section class="best-offer" *ngIf="bestOffer() || !isLoading()">
  <div class="container">
    <div class="best-offer__content">
      <div class="best-offer__badge">
        <i class="fas fa-star"></i>
        <span>Лучшее предложение недели</span>
      </div>
      
      <div *ngIf="bestOffer(); else fallbackOffer">
        <h2 class="best-offer__title">
          {{ bestOffer()?.brand }} {{ bestOffer()?.model }} {{ bestOffer()?.year }}
        </h2>
        <div class="best-offer__price">{{ formatPrice(bestOffer()?.price) }}</div>
        <ul class="best-offer__meta">
          <li><span>Год выпуска</span>{{ bestOffer()?.year }}</li>
          <li><span>Комплектация</span>{{ getCarFeatures(bestOffer()) }}</li>
        </ul>
        <div class="best-offer__actions">
          <button class="btn btn--primary" routerLink="/catalog">
            <i class="fas fa-search"></i>
            Смотреть все авто
          </button>
          <button class="btn btn--secondary" [routerLink]="['/car', bestOffer()?.id]">
            <i class="fas fa-eye"></i>
            Подробнее
          </button>
        </div>
      </div>
      
      <ng-template #fallbackOffer>
        <div *ngIf="fallbackCar(); else staticFallback">
          <h2 class="best-offer__title">
            {{ fallbackCar()?.brand }} {{ fallbackCar()?.model }} {{ fallbackCar()?.year }}
          </h2>
          <div class="best-offer__price">{{ formatPrice(fallbackCar()?.price) }}</div>
          <ul class="best-offer__meta">
            <li><span>Год выпуска</span>{{ fallbackCar()?.year }}</li>
            <li><span>Комплектация</span>{{ getCarFeatures(fallbackCar()) }}</li>
          </ul>
          <div class="best-offer__actions">
            <button class="btn btn--primary" routerLink="/catalog">
              <i class="fas fa-search"></i>
              Смотреть все авто
            </button>
            <button class="btn btn--secondary" routerLink="/catalog">
              <i class="fas fa-phone"></i>
              Консультация
            </button>
          </div>
        </div>
        
        <ng-template #staticFallback>
          <h2 class="best-offer__title">BMW X5 2023</h2>
          <div class="best-offer__price">2.5M ₽</div>
          <ul class="best-offer__meta">
            <li><span>Год выпуска</span>2023</li>
            <li><span>Комплектация</span>Полный привод • 45 000 км • В наличии в Москве</li>
          </ul>
          <div class="best-offer__actions">
            <button class="btn btn--primary" routerLink="/catalog">
              <i class="fas fa-search"></i>
              Смотреть все авто
            </button>
            <button class="btn btn--secondary" routerLink="/catalog">
              <i class="fas fa-phone"></i>
              Консультация
            </button>
          </div>
        </ng-template>
      </ng-template>
    </div>
  </div>
</section>

<!-- Showcase Section -->
<section class="showcase" id="collections">
  <div class="container">
    <div class="showcase__header">
      <div class="showcase__title-section">
        <h2 class="showcase__title">Подборки, которые мы рекомендуем</h2>
        <p class="showcase__subtitle">
          Выберите сценарий — мы подсветим автомобили, подходящие под ваши задачи.
          Подбор формируется автоматически в реальном времени.
        </p>
      </div>
      <a class="btn btn--secondary" routerLink="/catalog">Открыть весь каталог</a>
    </div>

    <div class="showcase__filters">
      <button
        *ngFor="let filter of showcaseFilters; let i = index"
        type="button"
        class="filter-chip"
        [class.active]="selectedFilter()?.id === filter.id"
        (click)="selectFilter(filter)">
        <span class="filter-chip__title">{{ filter.title }}</span>
        <small class="filter-chip__subtitle">{{ filter.subtitle }}</small>
      </button>
    </div>

    <div class="showcase__cars" *ngIf="!isLoading() && filteredCars().length > 0; else loadingOrEmpty">
      <app-car-card 
        *ngFor="let car of filteredCars(); let i = index"
        [car]="car"
        class="car-card-wrapper"></app-car-card>
    </div>
    
    <ng-template #loadingOrEmpty>
      <div class="loading" *ngIf="isLoading(); else emptyState">
        <div class="skeleton" *ngFor="let _ of [].constructor(6); let i = index"></div>
      </div>
      <ng-template #emptyState>
        <div class="empty-state">
          <div class="empty-state__content">
            <i class="fas fa-car"></i>
            <h3>Автомобили не найдены</h3>
            <p>Попробуйте изменить фильтры или загрузить каталог заново</p>
            <button class="btn btn--primary" (click)="selectFilter(showcaseFilters[0])">
              <i class="fas fa-refresh"></i>
              Обновить
            </button>
          </div>
        </div>
      </ng-template>
    </ng-template>
  </div>
</section>

<!-- Why Us Section -->
<section class="why-us" id="why-us">
  <div class="container">
    <div class="why-us__grid">
      <div class="why-us__content">
        <h3 class="why-us__title">Почему клиенты доверяют Prime Auto</h3>
        <p class="why-us__description">
          Мы соединяем классический подход к покупке авто и современные цифровые инструменты, 
          чтобы сделать путь к новой машине понятным и безопасным.
        </p>
        <ul class="why-us__features">
          <li class="feature-item">
            <div class="feature-item__icon">
              <i class="fas fa-shield-alt"></i>
            </div>
            <div class="feature-item__content">
              <h4>Финансовая прозрачность</h4>
              <p>Фиксируем стоимость в договоре, все платежи проходят официально.</p>
            </div>
          </li>
          <li class="feature-item">
            <div class="feature-item__icon">
              <i class="fas fa-tools"></i>
            </div>
            <div class="feature-item__content">
              <h4>Экспертная инспекция</h4>
              <p>Инженеры с опытом работы в дилерских центрах составляют техническое заключение.</p>
            </div>
          </li>
          <li class="feature-item">
            <div class="feature-item__icon">
              <i class="fas fa-headset"></i>
            </div>
            <div class="feature-item__content">
              <h4>Люди и сервис</h4>
              <p>Персональный менеджер на связи 24/7, помощь с trade-in и кредитом партнёров.</p>
            </div>
          </li>
        </ul>
      </div>
      
      <div class="why-us__visual">
        <div class="why-us__image">
          <img ngSrc="/assets/hero/team.svg" alt="Команда Prime Auto" width="540" height="320">
        </div>
        <div class="why-us__stat">
          <div class="stat-number">+17%</div>
          <p>Авто с гарантией от производителя благодаря работе с официальными партнёрами.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Popular Cars Section -->
<section class="popular">
  <div class="container">
    <div class="popular__header">
      <h2 class="popular__title">Живой каталог</h2>
      <p class="popular__subtitle">
        Алгоритм собирает автомобили из базы, проверяет актуальность и показывает только то,
        что доступно прямо сейчас.
      </p>
    </div>
    
    <div class="popular__cars">
      <app-car-card 
        *ngFor="let car of popular(); let i = index"
        [car]="car"
        class="car-card-wrapper"></app-car-card>
    </div>
  </div>
</section>

<!-- Stories Section -->
<section class="stories" *ngIf="soldRecently().length">
  <div class="container">
    <div class="stories__grid">
      <div class="stories__intro">
        <h3 class="stories__title">Свежие истории клиентов</h3>
        <p class="stories__description">
          Короткие заметки о том, как проходит путь от запроса до выдачи ключей. 
          Каждая история — живое подтверждение процесса.
        </p>
        <a class="btn btn--primary" routerLink="/contacts">Получить консультацию</a>
      </div>
      
      <div class="stories__list">
        <article class="story-card" *ngFor="let car of soldRecently(); let i = index">
          <div class="story-card__header">
            <span class="story-card__car">{{ car.brand }} {{ car.model }}</span>
            <small class="story-card__year">{{ car.year }}</small>
          </div>
          <p class="story-card__text">
            Доставили за {{ 12 + (car.id % 7) }} дней. Клиент получил выгоду {{ (car.price * 0.07) | number:'1.0-0' }} ₽
            по сравнению с рынком РФ.
          </p>
        </article>
      </div>
    </div>
  </div>
</section>

<!-- CTA Section -->
<section class="cta" id="contact-form">
  <div class="container">
    <div class="cta__content">
      <h2 class="cta__title">Расскажите о вашем автомобиле мечты</h2>
      <p class="cta__description">
        Укажите три параметра — и в течение суток мы подготовим прозрачные предложения 
        с расчётом пошлин и доставки.
      </p>
      <a class="btn btn--primary btn--large" routerLink="/contacts">
        <i class="fas fa-paper-plane"></i>
        Оставить заявку
      </a>
    </div>
  </div>
</section>
